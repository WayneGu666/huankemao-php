(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a520dbb"],{"4de4":function(e,t,a){"use strict";var l=a("23e7"),o=a("b727").filter,n=a("1dde"),r=a("ae40"),i=n("filter"),s=r("filter");l({target:"Array",proto:!0,forced:!i||!s},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},"782f":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"custom-label"},[a("el-container",[a("el-aside",{staticClass:"tabs",staticStyle:{width:"210px"}},[a("div",{staticClass:"group-main"},[a("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:e.handleAddLabelGroup}},[e._v("新增分组")]),a("el-tree",{ref:"tree",staticStyle:{"margin-top":"20px"},attrs:{data:e.groupData,"node-key":"code","default-expand-all":"","expand-on-click-node":!1,"highlight-current":!0,"current-node-key":e.code},on:{"node-click":e.handleTreeNode},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var l=t.data;return[a("div",{staticClass:"tree-wrap"},[a("span",{class:e.code===l.code?"active name-wrap":"name-wrap"},[e._v(e._s(l.name))]),a("div",{staticClass:"drop-wrap"},[a("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"所有"!==l.name&&"未分组"!==l.name,expression:"data.name !== '所有' && data.name !== '未分组'"}],on:{command:function(t){return e.handleCommand(t,l)}}},[a("span",{staticClass:"el-dropdown-link span-wrap"},[a("i",{staticClass:"more el-icon-more"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑分组")]),a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除分组")])],1)],1)],1)])]}}])})],1)]),a("el-main",[a("div",{staticClass:"title"},[e._v(" "+e._s(e.$route.meta.title)+"管理 "),a("i",{staticClass:"iconfont icon-question-circle",staticStyle:{cursor:"pointer"},on:{click:function(t){e.showCourse=!e.showCourse}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showCourse,expression:"showCourse"}],staticClass:"course"},[a("p",[a("span",{staticClass:"black"},[e._v("1、标签分组名称不可重复，同一分组下的标签名称不可重复。")])]),a("p",[a("span",{staticClass:"black"},[e._v("2、标签组一旦被删除，该标签组下的标签将移至【未分组】。")])]),a("p",[a("span",{staticClass:"black"},[e._v("3、【未分组】为系统分组，不可修改与删除。")])])]),a("div",{staticClass:"btns"},[a("el-input",{staticStyle:{width:"200px",margin:"0 10px"},attrs:{size:"small",placeholder:"搜索标签名称"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:e.handleSearch}},[e._v("查找")]),a("el-button",{staticClass:"btn-white",attrs:{size:"small"},on:{click:function(t){e.keyword=""}}},[e._v(" 清空 ")]),a("el-button",{class:0!==e.selectData.length?"btn-blue right":"btn-opacity right",attrs:{disabled:0===e.selectData.length,size:"small"},on:{click:e.delTags}},[e._v("删除标签")]),a("el-button",{class:0===e.selectData.length?"btn-blue":"btn-opacity",attrs:{disabled:0!==e.selectData.length,size:"small"},on:{click:e.handleAddLabel}},[e._v("新建标签")])],1),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"加载中...","element-loading-spinner":"el-icon-loading",data:e.tableData,"tooltip-effect":"dark","header-cell-style":{color:"#333",fontSize:"14px",backgroundColor:"#F6F7FB",fontWeight:"normal"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"标签名称"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"flex-wrap"},[a("span",{attrs:{size:"small"}},[e._v(" "+e._s(t.row.name)+" ")])])}}])}),a("el-table-column",{attrs:{prop:"customer_num",label:"客户数"}}),a("el-table-column",{attrs:{prop:"name",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editLabel(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.delLabel(t.row)}}},[e._v("删除")])]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.total,expression:"total !== 0"}],staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleLimitChange,"current-change":e.handlePageChange}})],1)])],1),a("el-dialog",{attrs:{width:"600px",title:"add"===e.operationType2?"新增标签":"edit"===e.operationType2?"编辑标签":"delete"===e.operationType2?"删除标签":"",visible:e.addGroupFlag2,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addGroupFlag2=t},close:function(t){return e.dialogBeforeClose()}}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:"add"===e.operationType2||"edit"===e.operationType2,expression:"operationType2 === 'add' || operationType2 === 'edit'"}],ref:"label",staticStyle:{"margin-top":"20px"},attrs:{model:e.label,rules:e.labelRules}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"add"===e.operationType2,expression:"operationType2 === 'add'"}],attrs:{label:"选择分组","label-width":"100px",size:"small"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.change},model:{value:e.label.labelGroupId,callback:function(t){e.$set(e.label,"labelGroupId",t)},expression:"label.labelGroupId"}},e._l(e.groupData2,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"edit"===e.operationType2,expression:"operationType2 === 'edit'"}],attrs:{label:"选择分组","label-width":"100px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small"},on:{change:e.change},model:{value:e.label.labelGroupId,callback:function(t){e.$set(e.label,"labelGroupId",t)},expression:"label.labelGroupId"}},e._l(e.groupData2,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"标签名称","label-width":"100px",prop:"labelValue"}},[a("el-input",{attrs:{placeholder:"请输入标签（不得超过15个字符）",size:"small"},model:{value:e.label.labelValue,callback:function(t){e.$set(e.label,"labelValue",t)},expression:"label.labelValue"}})],1),a("el-form-item",{attrs:{label:"","label-width":"100px"}},[a("span",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v("每个标签名称最多15个字，同时新建多个标签时，请用“空格” 隔开。")])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"delete"===e.operationType2,expression:"operationType2 === 'delete'"}],staticStyle:{"margin-top":"20px"}},[e._v(" 确定删除标签【"+e._s(e.label.labelGroupName)+"】吗? ")]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-white",attrs:{size:"small"},on:{click:function(t){e.addGroupFlag2=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:e.handleSubmitLabel}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{width:"600px",title:"add"===e.operationType?"新增分组":"edit"===e.operationType?"编辑分组":"delete"===e.operationType?"删除分组":"",visible:e.addGroupFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addGroupFlag=t},close:e.dialogBeforeClose}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:"add"===e.operationType||"edit"===e.operationType,expression:"operationType === 'add' || operationType === 'edit'"}],ref:"label",staticStyle:{"margin-top":"20px"},attrs:{model:e.label,rules:e.labelRules}},[a("el-form-item",{attrs:{label:"分组名称","label-width":"100px",prop:"labelGroupName"}},[a("el-input",{attrs:{placeholder:"请输入分组名（不得超过15个字符）",maxlength:"15",size:"small"},model:{value:e.label.labelGroupName,callback:function(t){e.$set(e.label,"labelGroupName",t)},expression:"label.labelGroupName"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"add"===e.operationType,expression:"operationType === 'add'"}],staticStyle:{"margin-bottom":"10px"},attrs:{label:"标签名称","label-width":"100px",prop:"labelValue"}},[a("el-input",{attrs:{placeholder:"请输入标签（不得超过15个字符）",size:"small"},model:{value:e.label.labelValue,callback:function(t){e.$set(e.label,"labelValue",t)},expression:"label.labelValue"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"add"===e.operationType,expression:"operationType === 'add'"}],attrs:{label:"","label-width":"100px"}},[a("span",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v("标签名称最多15个字符，同时新建多个标签时，请用“空格”隔开。")])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"delete"===e.operationType,expression:"operationType === 'delete'"}],staticStyle:{"margin-top":"20px"}},[e._v(" 【"+e._s(e.label.labelGroupName)+"】一旦删除，归属于该分组的所有标签都将被移至【未分组】，确定删除分组吗? ")]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-white",attrs:{size:"small"},on:{click:function(t){e.addGroupFlag=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:e.handleSubmitGroup}},[e._v("确 定")])],1)],1)],1)},o=[],n=(a("a623"),a("4de4"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("3ca3"),a("1276"),a("ddb0"),a("96cf"),a("1da1")),r=a("ade3"),i=a("365c"),s={data:function(){var e;return e={tagId:"",addGroupFlag:!1,addGroupFlag2:!1,page:1,total:0,limit:10,value:"",checkIndex:"default",tableData:[],groupData:[],groupData2:[],showCourse:!1,code:"",groupId:"",loading:!1,imageUrl:"",syncDate:"",selectData:[],label:{labelGroupName:"",labelValue:"",loading:!1,labelGroupId:"",visible:!1,groupName:"",title:""},operationType:"",operationType2:""},Object(r["a"])(e,"code",""),Object(r["a"])(e,"labelRules",{labelValue:[{required:!0,message:"请输入标签名称",trigger:"blur"}],labelGroupName:[{required:!0,message:"请输入标签组名称",trigger:"blur"}]}),Object(r["a"])(e,"keyword",""),e},watch:{keyword:function(e){e||this.reqGetCustomTag()}},mounted:function(){var e=this;this.getData(),this.$bus.$on("update",(function(){e.getData()}))},methods:{getData:function(){var e=this;this.loading=!0;var t=[];t[0]=Object(i["T"])({}),t[1]=Object(i["S"])({code:this.code,limit:this.limit,page:this.page,keyword:""}),Promise.all(t).then((function(t){e.loading=!1,200==t[0].code?0!=t[0].data.length?(e.groupData=JSON.parse(JSON.stringify(t[0].data)),e.groupData2=JSON.parse(JSON.stringify(t[0].data)),e.groupData.unshift({code:"",name:"所有"}),e.syncDate=t[0].data[0].update_at,e.$nextTick((function(){e.$refs.tree.setCurrentKey("")})),e.reqGetCustomTag()):(e.groupData=[{code:"",name:"所有"}],e.code=""):(e.$message.error(t[0].msg),e.groupData=[{code:"",name:"所有"}],e.code=""),200==t[1].code?(e.tableData=t[1].data,e.total=t[1].count):(e.$message.error(t[1].msg),e.tableData=[],e.total=0)}))},reqGetCustomTagGroup:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["T"])({});case 2:a=t.sent,200==a.code?0!=a.data.length?(e.groupData=JSON.parse(JSON.stringify(a.data)),e.groupData.unshift({code:"",name:"所有"}),e.syncDate=a.data[0].update_at,e.$nextTick((function(){e.$refs.tree.setCurrentKey(e.code)})),e.reqGetCustomTag()):(e.groupData=[{code:"",name:"所有"}],e.code="",e.total=0):(e.$message.error(a.msg),e.groupData=[{code:"",name:"所有"}],e.code="",e.total=0);case 4:case"end":return t.stop()}}),t)})))()},reqGetCustomTag:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(i["S"])({code:e.code,limit:e.limit,page:e.page,keyword:e.keyword});case 3:a=t.sent,e.loading=!1,200==a.code?(e.tableData=a.data,e.total=a.count):(e.$message.error(a.msg),e.tableData=[]);case 6:case"end":return t.stop()}}),t)})))()},reqAddCustomLabel:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["s"])(e);case 2:l=a.sent,200===l.code?(t.getData(),t.addGroupFlag2=!1,t.addGroupFlag=!1,t.$message.success(l.msg)):t.$message.error(l.msg);case 4:case"end":return a.stop()}}),a)})))()},handleTreeNode:function(e){this.page=1,this.groupId=e.id,this.label.labelGroupId=e.id,this.code=e.code,this.reqGetCustomTag()},handleCommand:function(e,t){this.operationType=e,"add"===e?(this.parent_id=t.id,this.addGroupFlag=!0):"edit"===e?(this.code=t.code,this.group_id=t.id,this.label.labelGroupName=t.name,this.addGroupFlag=!0):"delete"===e&&(this.group_id=t.id,this.label.labelGroupName=t.name,this.addGroupFlag=!0)},handleSelectionChange:function(e){this.selectData=e},change:function(){console.log(this.label.labelGroupId)},editLabel:function(e){this.tagId=e.id,this.label.labelGroupId=e.parent_code,this.label.labelValue=e.name,this.operationType2="edit",this.addGroupFlag2=!0},delLabel:function(e){var t=this;console.log(e),this.tagId=e.id,this.label.labelGroupName=e.name,this.$confirm("确认删除该标签？","提示",{cancelButtonClass:"btn-white",confirmButtonClass:"btn-blue",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then((function(){var e=[];e.push(t.tagId),t.delTag(e)})).catch((function(){}))},handleCheckList:function(e,t){this.code=t,this.reqGetCustomTag(),this.checkIndex=e},handleLimitChange:function(e){this.limit=e,this.reqGetCustomTag()},handlePageChange:function(e){this.page=e,this.reqGetCustomTag()},handleSubmitGroup:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("add"!=e.operationType){t.next=4;break}e.$refs.label.validate((function(t){if(t){var a=[],l=!0;a=e.label.labelValue.split(" "),a=a.filter((function(e){return 0!=e})),l=a.every((function(e){return e.length<=15})),l?(a.map((function(e,t){a[t]={name:e}})),e.reqAddCustomLabel({group_name:e.label.labelGroupName,tag:a})):e.$message.warning("每个标签最多15个字")}})),t.next=16;break;case 4:if("edit"!=e.operationType){t.next=11;break}return t.next=7,Object(i["J"])({code:e.code,type:1,name:e.label.labelGroupName});case 7:a=t.sent,200==a.code&&(e.addGroupFlag=!1,e.$message({type:"success",message:"修改成功"}),e.getData()),t.next=16;break;case 11:if("delete"!=e.operationType){t.next=16;break}return t.next=14,Object(i["J"])({code:e.code,type:2});case 14:l=t.sent,200==l.code&&(e.addGroupFlag=!1,e.$message({type:"success",message:"删除成功"}),e.getData());case 16:case"end":return t.stop()}}),t)})))()},handleSubmitLabel:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("add"!=e.operationType2){t.next=4;break}e.$refs.label.validate((function(t){if(t){var a=[],l=!0;a=e.label.labelValue.split(" "),a=a.filter((function(e){return 0!=e})),l=a.every((function(e){return e.length<=15})),l?(a.map((function(e,t){a[t]={name:e}})),e.reqAddCustomLabel({group_id:e.label.labelGroupId,tag:a})):e.$message.warning("每个标签最多15个字")}})),t.next=9;break;case 4:if("edit"!=e.operationType2){t.next=9;break}return t.next=7,Object(i["K"])({id:e.tagId,type:1,name:e.label.labelValue,parent_code:e.label.labelGroupId});case 7:a=t.sent,200==a.code&&(e.$message({type:"success",message:"修改成功"}),e.addGroupFlag2=!1,e.getData());case 9:case"end":return t.stop()}}),t)})))()},delTags:function(){var e=this;this.$confirm("确认删除标签？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],e.selectData.map((function(e){a.push(e.id)})),e.delTag(a);case 3:case"end":return t.stop()}}),t)})))).catch((function(){}))},delTag:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["K"])({id:e,type:2});case 2:l=a.sent,200==l.code&&(t.$message({type:"success",message:"删除成功"}),t.addGroupFlag2=!1,t.getData());case 4:case"end":return a.stop()}}),a)})))()},dialogBeforeClose:function(e){this.$refs["label"].resetFields()},handleAddLabel:function(){this.operationType2="add",this.label.labelValue="",this.label.labelGroupId=this.label.labelGroupId||this.groupData[1].id,this.addGroupFlag2=!0},handleAddLabelGroup:function(){this.operationType="add",this.label.labelGroupName="",this.label.labelValue="",this.label.labelGroupId="",this.addGroupFlag=!0},handleSearch:function(){this.keyword&&this.reqGetCustomTag()}}},c=s,d=(a("a5bd"),a("2877")),u=Object(d["a"])(c,l,o,!1,null,"a6a0229c",null);t["default"]=u.exports},"83c2":function(e,t,a){},a5bd:function(e,t,a){"use strict";a("83c2")},a623:function(e,t,a){"use strict";var l=a("23e7"),o=a("b727").every,n=a("a640"),r=a("ae40"),i=n("every"),s=r("every");l({target:"Array",proto:!0,forced:!i||!s},{every:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},ade3:function(e,t,a){"use strict";function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,"a",(function(){return l}))},d81d:function(e,t,a){"use strict";var l=a("23e7"),o=a("b727").map,n=a("1dde"),r=a("ae40"),i=n("map"),s=r("map");l({target:"Array",proto:!0,forced:!i||!s},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-5a520dbb.128026b1.js.map