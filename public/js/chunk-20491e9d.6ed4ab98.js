(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20491e9d"],{"0a41":function(e,t,a){"use strict";a("9123")},"27c5":function(e,t,a){"use strict";var r,i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.setVisible?r("el-dialog",{attrs:{top:"0",title:"系统设置",visible:e.setVisible,width:"1300px","before-close":e.handleCloseSet},on:{"update:visible":function(t){e.setVisible=t}}},[r("div",{staticClass:"scroll"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main",attrs:{"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading"}},[r("p",[r("span"),r("span",[e._v("企业微信配置")])]),e.init?r("span",{staticClass:"info"},[e._v("当前未配置，数据无法同步，请先配置")]):e.success?r("span",{staticClass:"info"},[e._v("数据同步成功，无法修改配置。如需重新配置，请重新安装系统（重新安装需删除应用根目录下的install/install.lock）")]):e.lose?r("span",{staticClass:"info"},[e._v(" 配置信息有误，数据同步失败，请重新修改配置")]):e._e(),r("el-form",{ref:"form1",staticStyle:{"margin-top":"10px"},attrs:{"label-position":"left","label-width":"240px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"企业ID",prop:"wxk_id"}},[r("el-input",{attrs:{disabled:e.wxIdDisabled,size:"small"},on:{blur:e.handleIdBlur},model:{value:e.form.wxk_id,callback:function(t){e.$set(e.form,"wxk_id",t)},expression:"form.wxk_id"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(1)}}})],1),r("el-form-item",{attrs:{label:"通讯录Secret",prop:"wxk_address_book_secret"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.wxk_address_book_secret,callback:function(t){e.$set(e.form,"wxk_address_book_secret",t)},expression:"form.wxk_address_book_secret"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(2)}}})],1),r("el-form-item",{attrs:{label:"客户管理Secret",prop:"wxk_customer_admin_secret"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.wxk_customer_admin_secret,callback:function(t){e.$set(e.form,"wxk_customer_admin_secret",t)},expression:"form.wxk_customer_admin_secret"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(3)}}})],1),r("el-form-item",{attrs:{label:"客户管理回调URL",prop:"wxk_customer_callback_url",required:""}},[r("el-input",{staticStyle:{width:"610px"},attrs:{disabled:!0,size:"small"},model:{value:e.form.wxk_customer_callback_url,callback:function(t){e.$set(e.form,"wxk_customer_callback_url",t)},expression:"form.wxk_customer_callback_url"}}),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.form.wxk_customer_callback_url)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(4)}}})],1),r("el-form-item",{attrs:{label:"客户管理回调token",prop:"wxk_customer_callback_token"}},[r("el-input",{staticStyle:{width:"520px"},attrs:{size:"small"},on:{blur:e.handleTokenBlur},model:{value:e.form.wxk_customer_callback_token,callback:function(t){e.$set(e.form,"wxk_customer_callback_token",t)},expression:"form.wxk_customer_callback_token"}}),r("el-button",{staticClass:"btn-white",attrs:{size:"small"},on:{click:function(t){return e.handleRandom("token")}}},[e._v("随机生成")]),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.form.wxk_customer_callback_token)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(5)}}})],1),r("el-form-item",{attrs:{label:"客户管理回调EncodongAESKey",prop:"wxk_customer_callback_key"}},[r("el-input",{staticStyle:{width:"520px"},attrs:{size:"small"},on:{blur:e.handleKeyBlur},model:{value:e.form.wxk_customer_callback_key,callback:function(t){e.$set(e.form,"wxk_customer_callback_key",t)},expression:"form.wxk_customer_callback_key"}}),r("el-button",{staticClass:"btn-white",attrs:{size:"small"},on:{click:function(t){return e.handleRandom("key")}}},[e._v("随机生成")]),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.form.wxk_customer_callback_key)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(6)}}})],1)],1),r("p",[r("span"),r("span",[e._v("自建应用配置")])]),r("el-form",{ref:"form2",staticStyle:{"margin-top":"10px"},attrs:{"label-position":"left","label-width":"240px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"自建应用AgentId",prop:"wxk_app_agent_id"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.wxk_app_agent_id,callback:function(t){e.$set(e.form,"wxk_app_agent_id",t)},expression:"form.wxk_app_agent_id"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(8)}}})],1),r("el-form-item",{attrs:{label:"自建应用Secret",prop:"wxk_app_secret"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.wxk_app_secret,callback:function(t){e.$set(e.form,"wxk_app_secret",t)},expression:"form.wxk_app_secret"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(9)}}})],1),r("el-form-item",{attrs:{label:"授权登录回调域"}},[r("el-input",{staticStyle:{width:"610px"},attrs:{disabled:"",size:"small"},model:{value:e.domain,callback:function(t){e.domain=t},expression:"domain"}}),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.domain)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(10)}}})],1),r("el-form-item",{attrs:{label:"下载应用Logo"}},[r("div",{staticClass:"download"},[r("img",{attrs:{src:a("9d64"),width:"75",alt:""}}),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(){e.downloadIamge()}}},[e._v("点击下载")])],1)])],1),r("p",[r("span"),r("span",[e._v("公众号配置")])]),r("el-form",{ref:"form3",staticStyle:{"margin-top":"10px"},attrs:{"label-position":"left","label-width":"240px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"Appid"}},[r("el-input",{attrs:{disabled:e.appIdDisabled,size:"small"},model:{value:e.form.wxk_public_app_id,callback:function(t){e.$set(e.form,"wxk_public_app_id",t)},expression:"form.wxk_public_app_id"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(11)}}})],1),r("el-form-item",{attrs:{label:"AppSecret"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.wxk_public_app_secret,callback:function(t){e.$set(e.form,"wxk_public_app_secret",t)},expression:"form.wxk_public_app_secret"}}),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(12)}}})],1)],1),r("p",[r("span"),r("span",[e._v("聊天工具栏配置")])]),r("span",{staticClass:"info"},[e._v("工具栏配置应用于【聊天工具栏】-【聊天资料】功能，且须提前配置自建应用")]),r("el-form",{ref:"form3",staticStyle:{"margin-top":"10px"},attrs:{"label-position":"left","label-width":"240px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"聊天资料应用主页"}},[r("el-input",{staticStyle:{width:"610px"},attrs:{disabled:"",size:"small"},model:{value:e.chat_app_home_url,callback:function(t){e.chat_app_home_url=t},expression:"chat_app_home_url"}}),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.chat_app_home_url)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(13)}}})],1),r("el-form-item",{attrs:{label:"可信域名配置"}},[r("el-input",{staticStyle:{width:"610px"},attrs:{disabled:"",size:"small"},model:{value:e.domain,callback:function(t){e.domain=t},expression:"domain"}}),r("el-button",{staticClass:"btn-blue",attrs:{size:"small"},on:{click:function(t){return e.handleCopy(t,e.domain)}}},[e._v("一键复制")]),r("img",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{src:a("dfdd"),width:"14px",alt:""},on:{click:function(t){return e.handleHelp(14)}}})],1),r("el-form-item",{attrs:{label:"域名校验"}},[0===e.fileList.length?r("el-upload",{attrs:{action:e.reqUploadFile,"on-success":e.handleSuccess,"on-remove":e.handleRemove,data:e.uploadData,name:"domain_verification_file","before-upload":e.beforeImgUpload,multiple:"",limit:1}},[r("el-button",{staticClass:"btn-blue",staticStyle:{"margin-left":"0px"},attrs:{icon:"el-icon-upload",size:"small"}},[e._v("上传校验文件")])],1):r("p",{staticClass:"file-list"},[e._v(" "+e._s(e.fileList[0].name)+" "),r("i",{staticClass:"el-icon-close",on:{click:function(t){e.fileList=[]}}})])],1),r("el-form-item",[r("el-button",{staticClass:"btn-blue",staticStyle:{margin:"20px 0 0"},attrs:{size:"small"},on:{click:e.handleSubmit}},[e._v("保存配置")])],1)],1)],1),e.setVisible?r("div",[r("div",{attrs:{id:"footer"}}),r("remote-js",{attrs:{src:"https://cdn.wulabh.com/ptsc/1.0.0/ptsc.min.js"}}),r("remote-js",{attrs:{src:"https://cdn.wulabh.com/jquery/2.1.4/jquery.min.js"}})],1):e._e()])]):e._e()},n=[],s=(a("d3b7"),a("3ca3"),a("ddb0"),a("ade3")),l=(a("96cf"),a("1da1")),o=a("365c"),c=a("b311"),u=a.n(c),d=a("8237"),m=a.n(d),_={components:{"remote-js":{render:function(e){return e("script",{attrs:{type:"text/javascript",src:this.src}})},props:{src:{type:String,required:!0}}}},props:{setVisible:{type:Boolean,default:!1}},data:function(){return{form:{wxk_address_book_secret:"",wxk_id:"",wxk_customer_callback_url:"",wxk_customer_admin_secret:"",wxk_customer_callback_token:"",wxk_customer_callback_key:"",wxk_app_agent_id:"",wxk_app_secret:"",wxk_public_app_id:"",wxk_public_app_secret:"",domain_verification_file:""},loading:!1,loadingText:"拼命加载中...",rules:{wxk_address_book_secret:[{required:!0,message:"请输入通讯录Secret",trigger:"blur"}],wxk_customer_admin_secret:[{required:!0,message:"请输入客户管理Secret",trigger:"blur"}],wxk_id:[{required:!0,message:"请输入企业ID",trigger:"blur"}],wxk_customer_callback_token:[{required:!0,message:"请输入客户管理回调Token",trigger:"blur"}],wxk_customer_callback_key:[{required:!0,message:"请输入客户管理回调EncodongAESKey",trigger:"blur"}],wxk_app_agent_id:[{required:!0,message:"请输入自建应用AgentId",trigger:"blur"}],wxk_app_secret:[{required:!0,message:"请输入自建应用Secret",trigger:"blur"}]},success:!1,lose:!1,init:!1,page:1,limit:10,keyword:"",domain:"",chat_app_home_url:"",fileList:[],reqUploadFile:"",uploadData:{},wxIdDisabled:!1,appIdDisabled:!1}},watch:{setVisible:function(e){e&&this.getConfigAll()}},created:function(){var e=parseInt((new Date).getTime()/1e3),t=localStorage.getItem("user_id")||"",a=localStorage.getItem("token")||"",r=m()(t+a+e+m()("huankemaoupload_domain_verification_file"));this.uploadData.time=e,this.uploadData.user_id=t,this.uploadData.token=a,this.uploadData.sign=r,this.reqUploadFile=o["Bb"]},methods:(r={getConfigAll:function(){var e=this;this.loading=!0;var t=[];t[0]=Object(o["ib"])({page:1,limit:1,keyword:""}),t[1]=Object(o["O"])({}),Promise.all(t).then((function(t){e.loading=!1,200===t[0].code?0!==t[0].data.length?(e.form={id:t[0].data[0].id,wxk_address_book_secret:t[0].data[0].wxk_address_book_secret,wxk_id:t[0].data[0].wxk_id,wxk_customer_admin_secret:t[0].data[0].wxk_customer_admin_secret,wxk_customer_callback_token:t[0].data[0].wxk_customer_callback_token,wxk_customer_callback_key:t[0].data[0].wxk_customer_callback_key,wxk_app_agent_id:t[0].data[0].wxk_app_agent_id,wxk_app_secret:t[0].data[0].wxk_app_secret,wxk_public_app_id:t[0].data[0].wxk_public_app_id,wxk_public_app_secret:t[0].data[0].wxk_public_app_secret},t[0].data[0].domain_verification_file?e.fileList=[{name:"域名校验文件.txt",url:t[0].data[0].domain_verification_file}]:e.fileList=[],Boolean(t[0].data[0].wxk_id)?(e.init=!1,e.success=!0,e.lose=!1,e.wxIdDisabled=!0):(e.init=!1,e.success=!1,e.lose=!0,e.getToken(),e.getKey(),e.reqGetConfigRandom(),e.wxIdDisabled=!1),Boolean(t[0].data[0].wxk_public_app_id)?e.appIdDisabled=!0:e.appIdDisabled=!1):(e.init=!0,e.success=!1,e.lose=!1,e.form={wxk_address_book_secret:"",wxk_id:"",wxk_customer_callback_url:"",wxk_customer_admin_secret:"",wxk_customer_callback_token:"",wxk_customer_callback_key:"",wxk_app_agent_id:"",wxk_app_secret:"",wxk_public_app_id:"",wxk_public_app_secret:""},e.getToken(),e.getKey(),e.reqGetConfigRandom(),e.wxIdDisabled=!1,e.appIdDisabled=!1):(e.$message.error(t[0].msg),e.wxIdDisabled=!1,e.appIdDisabled=!1),200===t[1].code?(e.form.wxk_customer_callback_url=t[1].data.wxk_customer_callback_url,e.form.domain_verification_file=t[1].data.domain_verification_file,e.domain=t[1].data.domain,e.chat_app_home_url=t[1].data.chat_app_home_url):(e.$message.error(t[1].msg),e.domain="",e.chat_app_home_url="")}))},editId:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:6,wxk_id:e.form.wxk_id});case 2:t.sent;case 3:case"end":return t.stop()}}),t)})))()},handleIdBlur:function(){this.form.wxk_id&&this.editId()},reqAddWechat:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["x"])(t.form);case 2:r=a.sent,t[e]=!0,200==r.code?t.reqSyncConfig():t.$message.error(r.msg);case 5:case"end":return a.stop()}}),a)})))()},reqSyncConfig:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.loadingText="项目初始化同步中...",t.next=4,Object(o["zb"])({});case 4:a=t.sent,e.loading=!1,e.loadingText="",200==a.code?(e.getConfigAll(),e.$message.success("同步成功！")):(e.reqDelConfig(),e.$message.error("同步失败！"));case 8:case"end":return t.stop()}}),t)})))()},reqDelConfig:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["C"])({});case 2:t.sent,e.reqGetWechatList();case 4:case"end":return t.stop()}}),t)})))()},reqGetConfigRandom:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:3});case 2:a=t.sent,200===a.code?(e.form.wxk_customer_callback_url=a.data.path,e.form.wxk_customer_callback_token=a.data.token,e.form.wxk_customer_callback_key=a.data.aes_key,e.domain=a.data.domain):(e.$message.error(a.msg),e.form.wxk_customer_callback_url="",e.form.wxk_customer_callback_token="",e.form.wxk_customer_callback_key="",e.domain="");case 4:case"end":return t.stop()}}),t)})))()},getToken:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:1});case 2:a=t.sent,200===a.code?e.form.wxk_customer_callback_token=a.data.token:e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()},getKey:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:2});case 2:a=t.sent,200===a.code?e.form.wxk_customer_callback_key=a.data.aes_key:e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()}},Object(s["a"])(r,"editId",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:6,wxk_id:e.form.wxk_id});case 2:t.sent;case 3:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(r,"editToken",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:4,wxk_customer_callback_token:e.form.wxk_customer_callback_token});case 2:t.sent,e.tokenDis=!0;case 4:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(r,"editKey",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["P"])({type:5,wxk_customer_callback_aes_key:e.form.wxk_customer_callback_key});case 2:t.sent,e.keyDis=!0;case 4:case"end":return t.stop()}}),t)})))()})),Object(s["a"])(r,"handleSubmit",(function(){var e=this,t=[];this.$refs["form1"].validate((function(e){t[0]=!!e})),this.$refs["form2"].validate((function(e){t[1]=!!e})),this.$refs["form3"].validate((function(e){t[2]=!!e})),Promise.all(t).then((function(t){t[0]&&t[1]&&t[2]&&e.reqAddWechat()}))})),Object(s["a"])(r,"handleCopy",(function(e,t){var a=this,r=new u.a(e.target,{text:function(){return t}});r.on("success",(function(e){a.$message.success("复制成功"),r.off("error"),r.off("success"),r.destroy()})),r.onClick(e)})),Object(s["a"])(r,"handleRandom",(function(e){"token"===e?this.getToken():"key"===e&&this.getKey()})),Object(s["a"])(r,"handleIdBlur",(function(){this.form.wxk_id&&this.editId()})),Object(s["a"])(r,"handleTokenBlur",(function(){/^[0-9a-zA-Z]{1,30}$/gi.test(this.form.wxk_customer_callback_token)?this.editToken():this.$message.warning("请输入长度30位以内的字母、数字")})),Object(s["a"])(r,"handleKeyBlur",(function(){/^[0-9a-zA-Z]{43}$/gi.test(this.form.wxk_customer_callback_key)?this.editKey():this.$message.warning("请输入固定长度43位的字母、数字")})),Object(s["a"])(r,"handleHelp",(function(e){this.$bus.$emit("showHelp",e)})),Object(s["a"])(r,"close",(function(e){this.helpVisible=e})),Object(s["a"])(r,"handleCloseSet",(function(e){this.$emit("handleCloseSet")})),Object(s["a"])(r,"downloadIamge",(function(){var e=document.createElement("a");e.href="/logo.png",e.download="自建应用Logo",e.click()})),Object(s["a"])(r,"handleSuccess",(function(e,t,a){this.fileList=a,200===e.code?this.form.domain_verification_file=e.data:this.$message.error(e.msg)})),Object(s["a"])(r,"handleRemove",(function(e,t){this.fileList=t,0===t.length&&(this.form.domain_verification_file="")})),Object(s["a"])(r,"beforeImgUpload",(function(e){var t="text/plain"===e.type,a=e.size/1024/1024<=1;return t?a||this.$message.error("上传文件大小不能超过 1MB!"):this.$message.error("上传校验文件只能是 txt 格式!"),t&&a})),r)},p=_,f=(a("0a41"),a("2877")),k=Object(f["a"])(p,i,n,!1,null,"57bcba78",null);t["a"]=k.exports},9123:function(e,t,a){}}]);
//# sourceMappingURL=chunk-20491e9d.6ed4ab98.js.map